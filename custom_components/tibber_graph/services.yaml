# Service definitions for Tibber Graph integration

set_option:
  name: Set option
  description: Update one or more configuration options for a Tibber Graph entity.
  fields:
    entity_id:
      name: Entity ID
      description: The entity ID of the Tibber Graph camera to update.
      required: true
      example: "camera.tibber_graph_nord_pool_price"
      selector:
        entity:
          integration: tibber_graph
          domain: camera
    options:
      name: Options
      description: Dictionary of options to update, where keys are option names (as defined in OPTIONS.md) and values are the new values. All values will be validated before applying.
      required: true
      example: '{"theme": "light", "canvas_width": 1920, "show_average_price_line": true}'
      selector:
        object:
    overwrite:
      name: Overwrite
      description: When true, all options not provided in the options dictionary will be reset to their default values. When false (default), only provided options are updated.
      required: false
      default: false
      example: false
      selector:
        boolean:

reset_option:
  name: Reset option
  description: Reset one or more configuration options to their default values for a Tibber Graph entity.
  fields:
    entity_id:
      name: Entity ID
      description: The entity ID of the Tibber Graph camera to reset options for.
      required: true
      example: "camera.tibber_graph_nord_pool_price"
      selector:
        entity:
          integration: tibber_graph
          domain: camera
    options:
      name: Options
      description: List of option names to reset (as defined in OPTIONS.md). Leave empty or omit to reset all options to their default values.
      required: false
      example: '["theme", "canvas_width", "show_average_price_line"]'
      selector:
        object:

set_data_source:
  name: Set data source
  description: Change the price data source for a Tibber Graph entity. Can switch between Tibber integration and a custom price entity.
  fields:
    entity_id:
      name: Entity ID
      description: The entity ID of the Tibber Graph camera to update the data source for.
      required: true
      example: "camera.tibber_graph_nord_pool_price"
      selector:
        entity:
          integration: tibber_graph
          domain: camera
    price_entity_id:
      name: Price entity
      description: The entity ID of a sensor containing price data (see README.md for details). Leave empty to use the Tibber integration instead.
      required: false
      example: "sensor.nord_pool_price"
      selector:
        entity:
          domain: sensor
    data_attr:
      name: Data attribute
      description: The attribute to use for getting the price data from the data source entity. Omit to use defaults (see README.md for details).
      required: false
      example: "prices"
      selector:
        text:
    data_attr_start_field:
      name: Start time field name
      description: The field to use for getting the start time from each price point in the price data. Omit to use defaults (see README.md for details).
      required: false
      example: "start_time"
      selector:
        text:
    data_attr_start_fmt:
      name: Start timeformat string
      description: The datetime format string for parsing timestamps (using Python's strftime format codes, e.g., '%m/%d/%Y %H:%M:%S'). Omit to use ISO 8601 format.
      required: false
      example: "%m/%d/%Y %H:%M:%S"
      selector:
        text:
    data_attr_price_field:
      name: Price field name
      description: The field to use for getting the price value from each price point in the price data. Omit to use defaults (see README.md for details).
      required: false
      example: "price"
      selector:
        text:
    data_attr_price_factor:
      name: Price multiplication factor
      description: The factor to multiply each price value by for unit conversion or adding VAT (e.g., 0.001 to convert from kWh to MWh, or 1.25 to add 25% VAT). Can combine both (e.g., 0.00125 for MWh with 25% VAT). Omit to disable.
      required: false
      example: 0.001
      selector:
        number:
          min: 0.000001
          max: 1000
          step: any
          mode: box
    data_attr_price_add:
      name: Price addition
      description: The value to add to each price value after other transformations (e.g., to add a fixed grid fee per kWh). Omit to disable.
      required: false
      example: 0.05
      selector:
        number:
          min: -1000
          max: 1000
          step: any
          mode: box
    currency_attr:
      name: Currency attribute
      description: The attribute to use for getting the currency symbol from the data source entity. Omit to use defaults (see README.md for details).
      required: false
      example: "currency"
      selector:
        text:

render:
  name: Render
  description: Render the graph for a Tibber Graph entity.
  fields:
    entity_id:
      name: Entity ID
      description: The entity ID (or list of entity IDs) of the Tibber Graph camera to render. If not provided, all Tibber Graph entities are rendered.
      required: false
      example: "camera.tibber_graph_nord_pool_price"
      selector:
        entity:
          integration: tibber_graph
          domain: camera
          multiple: true

set_custom_theme:
  name: Set custom theme
  description: Set a custom theme for a Tibber Graph entity. Theme properties are optional; provided properties override the configured built-in theme. Call without theme_config to clear the custom theme and revert to the configured theme.
  fields:
    entity_id:
      name: Entity ID
      description: The entity ID of the Tibber Graph camera to set the custom theme for.
      required: true
      example: "camera.tibber_graph_nord_pool_price"
      selector:
        entity:
          integration: tibber_graph
          domain: camera
    theme_config:
      name: Theme config
      description: Dictionary containing theme properties to override. Omitted properties will fall back to the configured built-in theme. If omitted or empty, clears the custom theme and reverts to the configured theme.
      required: false
      example: '{"avgline_color": "#eab308", "avgline_style": ":", "axis_label_color": "#cfd6e6", "background_color": "#1c1c1c", "cheap_price_color": "#2d5a3d", "cheapline_color": "#34d399", "cheapline_style": ":", "fill_alpha": 0.18, "fill_color": "#7dc3ff", "grid_alpha": 0.45, "grid_color": "#2a2f36", "label_color": "#e6edf3", "label_color_avg": "#eab308", "label_color_max": "#fb7185", "label_color_min": "#34d399", "label_stroke": true, "nowline_alpha": 0.5, "nowline_color": "#ff6b6b", "plot_linewidth": 1.0, "price_line_color": "#7dc3ff", "price_line_color_above_avg": "#fb7185", "price_line_color_below_avg": "#7dc3ff", "price_line_color_near_avg": "#eab308", "spine_color": "#3a4250", "tick_color": "#cfd6e6", "tickline_color": "#1f2530"}'
      selector:
        object:

create_graph:
  name: Create graph
  description: Create a new Tibber Graph camera entity programmatically with specified configuration.
  fields:
    entity_name:
      name: Entity name
      description: The name of the new entity. Must be unique. If not provided, the name will be auto-generated from the price entity friendly name or Tibber home name. This will be prefixed with "Tibber Graph" for the camera entity name.
      required: false
      example: "Nord Pool Price"
      selector:
        text:
    price_entity_id:
      name: Price entity
      description: The entity ID of a sensor containing price data (see README.md for details). If not provided, the Tibber integration will be used.
      required: false
      example: "sensor.nord_pool_price"
      selector:
        entity:
          domain: sensor
    options:
      name: Options
      description: Dictionary of options to set for the new entity. Keys should be option names (as defined in OPTIONS.md), values should be the corresponding option values. All values will be validated before applying.
      required: false
      example: '{"theme": "light", "canvas_width": 1920, "show_average_price_line": true}'
      selector:
        object:
    custom_theme:
      name: Custom theme
      description: Dictionary defining a custom theme to apply to the new entity. Keys should be theme property names (as defined in CUSTOM_THEME.md), values should be the corresponding color values. Must include all required theme fields.
      required: false
      example: '{"avgline_color": "#ffb347", "avgline_style": ":", "axis_label_color": "#d8b9ff", "background_color": "#1a0f2e", "cheap_price_color": "#2d3d5a", "cheapline_color": "#7cffb3", "cheapline_style": ":", "fill_alpha": 0.2, "fill_color": "#9d7cff", "grid_alpha": 0.4, "grid_color": "#3d2f50", "label_color": "#f0e6ff", "label_color_avg": "#ffb347", "label_color_max": "#ff6b9d", "label_color_min": "#7cffb3", "label_stroke": true, "nowline_alpha": 0.6, "nowline_color": "#ff6b9d", "plot_linewidth": 1.2, "price_line_color": "#9d7cff", "price_line_color_above_avg": "#ff6b9d", "price_line_color_below_avg": "#9d7cff", "price_line_color_near_avg": "#ffb347", "spine_color": "#503d70", "tick_color": "#d8b9ff", "tickline_color": "#2e1f45"}'
      selector:
        object:
    recreate:
      name: Recreate
      description: If true, recreate the entity if it already exists. If false (default), an error will be raised if an entity with the same name already exists.
      required: false
      default: false
      example: false
      selector:
        boolean:
    data_attr:
      name: Data attribute
      description: The attribute to use for getting the price data from the data source entity. Omit to use defaults (see README.md for details).
      required: false
      example: "prices"
      selector:
        text:
    data_attr_start_field:
      name: Start time field name
      description: The field to use for getting the start time from each price point in the price data. Omit to use defaults (see README.md for details).
      required: false
      example: "start_time"
      selector:
        text:
    data_attr_start_fmt:
      name: Start time format string
      description: The datetime format string for parsing timestamps (using Python's strftime format codes, e.g., '%m/%d/%Y %H:%M:%S'). Omit to use ISO 8601 format.
      required: false
      example: "%m/%d/%Y %H:%M:%S"
      selector:
        text:
    data_attr_price_field:
      name: Price field name
      description: The field to use for getting the price value from each price point in the price data. Omit to use defaults (see README.md for details).
      required: false
      example: "price"
      selector:
        text:
    data_attr_price_factor:
      name: Price multiplication factor
      description: The factor to multiply each price value by for unit conversion or adding VAT (e.g., 0.001 to convert from kWh to MWh, or 1.25 to add 25% VAT). Can combine both (e.g., 0.00125 for MWh with 25% VAT). Omit to disable.
      required: false
      example: 0.001
      selector:
        number:
          min: 0.000001
          max: 1000
          step: any
          mode: box
    data_attr_price_add:
      name: Price addition
      description: The value to add to each price value after other transformations (e.g., to add a fixed grid fee per kWh). Omit to disable.
      required: false
      example: 0.05
      selector:
        number:
          min: -1000
          max: 1000
          step: any
          mode: box
    currency_attr:
      name: Currency attribute
      description: The attribute to use for getting the currency symbol from the data source entity. Omit to use defaults (see README.md for details).
      required: false
      example: "currency"
      selector:
        text:

delete_graph:
  name: Delete graph
  description: Delete one or more Tibber Graph camera entities programmatically.
  fields:
    entity_id:
      name: Entity ID
      description: The entity ID (or list of entity IDs) of the Tibber Graph camera to delete.
      required: true
      example: "camera.tibber_graph_nord_pool_price"
      selector:
        entity:
          integration: tibber_graph
          domain: camera
          multiple: true
